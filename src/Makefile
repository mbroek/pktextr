# Makefile for pktextr.
# Copyright (c) 2002 by M. Broek.
# $Id$

include ../Makefile.global

SRCS		= crc.c logger.c xutil.c rdconfig.c aread.c rfcdate.c \
		  printable.c gmtoffset.c pktextract.c
HDRS		= crc.h logger.h xutil.h rdconfig.h aread.h rfcdate.h \
		  printable.h gmtoffset.h pktextract.h libs.h
OBJS		= crc.o logger.o xutil.o rdconfig.o aread.o rfcdate.o \
		  printable.o gmtoffset.o pktextract.o
OTHER		= Makefile

#############################################################################

.c.o:
		${CC} ${CFLAGS} ${INCLUDES} ${DEFINES} -c $<

all:		pktextract

pktextract:	${OBJS} ${LIBS}
		${CC} -o pktextract ${OBJS} ${LIBS}
		strip pktextract

clean:
		rm -f pktextract *.o *.h~ *.c~ core filelist Makefile.bak

install:	all
		${INSTALL} -c -s -m 0755 pktextract ${BINDIR}

filelist:	Makefile
		BASE=`pwd`; \
		BASE=`basename $${BASE}`; \
		(for f in ${SRCS} ${HDRS} ${OTHER} ;do echo ${PACKAGE}-${VERSION}/$${BASE}/$$f; done) >filelist

depend:
	@rm -f Makefile.bak; \
	mv Makefile Makefile.bak; \
	sed -e '/^# DO NOT DELETE/,$$d' Makefile.bak >Makefile; \
	${ECHO} '# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT' \
		>>Makefile; \
	${ECHO} '# Dependencies generated by make depend' >>Makefile; \
	for f in ${SRCS}; \
	do \
		${ECHO} "Dependencies for $$f:\c"; \
		${ECHO} "`basename $$f .c`.o:\c" >>Makefile; \
		for h in `sed -n -e \
			's/^#[ 	]*include[ 	]*"\([^"]*\)".*/\1/p' $$f`; \
		do \
			${ECHO} " $$h\c"; \
			${ECHO} " $$h\c" >>Makefile; \
		done; \
		${ECHO} " done."; \
		${ECHO} "" >>Makefile; \
	done; \
	${ECHO} '# End of generated dependencies' >>Makefile

# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT
# Dependencies generated by make depend
crc.o: ../config.h libs.h crc.h
logger.o: ../config.h libs.h crc.h xutil.h logger.h
xutil.o: ../config.h libs.h xutil.h
rdconfig.o: ../config.h libs.h xutil.h rdconfig.h
aread.o: ../config.h libs.h aread.h
rfcdate.o: ../config.h libs.h xutil.h logger.h gmtoffset.h rfcdate.h
printable.o: ../config.h libs.h xutil.h printable.h
gmtoffset.o: ../config.h libs.h gmtoffset.h
pktextract.o: ../config.h libs.h crc.h xutil.h logger.h rdconfig.h aread.h rfcdate.h printable.h pktextract.h
# End of generated dependencies
